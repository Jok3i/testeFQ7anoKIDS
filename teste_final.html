<!DOCTYPE html>
<html lang="pt-PT">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste Global de Avaliação: Físico-Química 7º Ano</title>
    <style>
        :root {
            --primary: #2c3e50;
            --secondary: #2980b9;
            --bg-color: #f8f9fa;
            --text-color: #333;
            --error-color: #e74c3c;
            --success-color: #27ae60;
            --card-bg: #fff;
        }
        body {
            font-family: system-ui, -apple-system, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
            padding: 20px;
            max-width: 850px;
            margin: 0 auto;
        }
        .header-container {
            text-align: center;
            margin-bottom: 40px;
            padding: 20px;
            background: var(--card-bg);
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            border-top: 5px solid var(--primary);
        }
        .header-container h1 { color: var(--primary); margin: 0 0 10px 0; }
        .header-container p { color: #666; margin: 0; }
        
        .btn-back {
            display: inline-block; margin-bottom: 20px; padding: 10px 15px;
            background-color: #e9ecef; color: var(--primary); text-decoration: none;
            border-radius: 6px; font-weight: bold; transition: 0.2s;
        }
        .btn-back:hover { background-color: #d3d9df; }
        
        .question-card {
            background: var(--card-bg); padding: 25px; margin-bottom: 25px;
            border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            border-left: 5px solid transparent;
        }
        .question-card.error {
            border-left-color: var(--error-color); animation: shake 0.4s;
        }
        .question-title { font-weight: bold; margin-bottom: 15px; font-size: 1.1rem; }
        
        .options-list { list-style: none; padding: 0; }
        .options-list li { margin-bottom: 10px; padding: 10px; border-radius: 4px; background: #f8f9fa; transition: 0.2s; }
        .options-list li:hover { background: #e9ecef; }
        label { cursor: pointer; display: flex; align-items: center; width: 100%; }
        input[type="radio"] { margin-right: 12px; transform: scale(1.2); }
        
        input[type="text"] {
            width: 100%; padding: 12px; margin-top: 5px;
            border: 1px solid #ccc; border-radius: 4px;
            font-size: 1rem; box-sizing: border-box;
        }
        select {
            width: 100%; padding: 12px; border: 1px solid #ccc;
            border-radius: 4px; font-size: 0.95rem; box-sizing: border-box; background-color: #fff;
        }
        .match-row {
            display: flex; align-items: center; justify-content: space-between;
            margin-bottom: 12px; background: #f8f9fa; padding: 12px; border-radius: 4px;
        }
        .match-label { font-weight: 500; width: 45%; padding-right: 15px; }
        .match-select-container { width: 55%; }

        button {
            display: block; width: 100%; padding: 18px;
            background-color: var(--secondary); color: #fff;
            border: none; border-radius: 8px; font-size: 1.2rem;
            font-weight: bold; cursor: pointer; transition: 0.3s;
            box-shadow: 0 4px 6px rgba(41, 128, 185, 0.2);
        }
        button:hover { background-color: #21618c; transform: translateY(-2px); }
        
        #result-container {
            margin-bottom: 25px; padding: 30px; background: #fff;
            border-radius: 8px; text-align: center; font-size: 1.5rem;
            font-weight: bold; display: none; border: 3px solid var(--secondary);
        }
        .error-msg { color: var(--error-color); font-size: 0.95rem; margin-top: 12px; display: none; font-weight: bold; }

        .correct-answer { background-color: #d4edda !important; color: #155724; border-left: 4px solid var(--success-color); }
        .wrong-answer { background-color: #f8d7da !important; color: #721c24; border-left: 4px solid var(--error-color); text-decoration: line-through; }
        .review-correction { font-size: 0.95rem; color: var(--success-color); font-weight: bold; margin-top: 8px; display: block; }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
    </style>
</head>
<body>

    <a href="index.html" class="btn-back">&larr; Voltar ao Menu Inicial</a>
    
    <div class="header-container">
        <h1>Teste Global: Físico-Química</h1>
        <p>Sistema Solar, Terra/Lua, Forças Gravíticas e Massa vs Peso</p>
    </div>

    <div id="result-container"></div>
    <form id="quiz-form">
        <div id="quiz-container"></div>
        <button type="submit" id="submit-btn">Submeter Teste Final</button>
    </form>

    <script>
        const quizData = [
            // SISTEMA SOLAR E TERRA
            {
                type: "mcq",
                question: "1. A Terra é, até onde sabemos, o único planeta com vida. Qual das seguintes opções apresenta as condições essenciais que permitem a existência de vida no nosso planeta?",
                options: [
                    "Ausência de atmosfera, luz solar intensa e crateras.",
                    "Distância ideal ao Sol, presença de água no estado líquido e atmosfera com oxigénio.",
                    "Elevada força gravítica, superfície totalmente rochosa e anéis planetários.",
                    "Proximidade aos planetas gasosos e ausência de estações do ano."
                ],
                correct: 1
            },
            {
                type: "tf",
                question: "2. No Sistema Solar, o período de translação de um planeta é tanto maior quanto maior for a sua distância ao Sol.",
                options: ["Verdadeiro", "Falso"],
                correct: 0
            },
            {
                type: "fill",
                question: "3. Considerando a relação geométrica no Sistema Solar, o planeta que demora menos tempo a completar uma volta ao Sol é...",
                correctAnswers: ["mercurio", "mercúrio"]
            },
            {
                type: "match",
                question: "4. Faz a correspondência correta entre os movimentos da Terra e os fenómenos que eles originam:",
                pairs: [
                    { id: "rot", label: "Rotação da Terra", correct: "opt1" },
                    { id: "trans_eixo", label: "Translação + Inclinação do eixo", correct: "opt2" }
                ],
                options: [
                    { val: "opt1", text: "Sucessão dos dias e das noites" },
                    { val: "opt2", text: "Estações do ano" },
                    { val: "opt3", text: "Fases da Lua" }
                ]
            },
            {
                type: "fill",
                question: "5. Numa experiência para medir a sombra de um objeto ao longo do dia, regista-se que a sombra atinge o seu comprimento mais __________ (curto/comprido) quando é meio-dia solar verdadeiro.",
                correctAnswers: ["curto", "pequeno"]
            },
            
            // FASES DA LUA E ECLIPSES
            {
                type: "mcq",
                question: "6. Porque razão não ocorrem eclipses do Sol e da Lua todos os meses?",
                options: [
                    "Porque a Lua para o seu movimento durante o Inverno.",
                    "Devido ao facto de os planos de órbita da Lua e da Terra não coincidirem perfeitamente.",
                    "Porque o Sol está demasiado longe durante grande parte do ano.",
                    "Devido à constante alteração da massa da Terra."
                ],
                correct: 1
            },
            {
                type: "tf",
                question: "7. Um eclipse total do Sol só pode ser observado por quem se encontrar na zona de sombra projetada pela Lua na superfície da Terra.",
                options: ["Verdadeiro", "Falso"],
                correct: 0
            },
            {
                type: "mcq",
                question: "8. Em que fase se encontra obrigatoriamente a Lua para que possa ocorrer um Eclipse Lunar?",
                options: ["Lua Nova.", "Quarto Crescente.", "Lua Cheia.", "Quarto Minguante."],
                correct: 2
            },
            
            // FORÇAS E GRAVIDADE
            {
                type: "match",
                question: "9. Relaciona as características do vetor que representa uma força com a sua definição técnica:",
                pairs: [
                    { id: "dir", label: "Direção", correct: "opt2" },
                    { id: "sen", label: "Sentido", correct: "opt1" },
                    { id: "int", label: "Intensidade", correct: "opt4" },
                    { id: "pto", label: "Ponto de Aplicação", correct: "opt3" }
                ],
                options: [
                    { val: "opt1", text: "Orientação da seta (ex: de cima para baixo)" },
                    { val: "opt2", text: "Linha de ação (ex: horizontal, vertical, oblíqua)" },
                    { val: "opt3", text: "Local onde a força atua no corpo" },
                    { val: "opt4", text: "Valor medido em newtons (N)" }
                ]
            },
            {
                type: "tf",
                question: "10. A força gravítica é considerada uma força de contacto, pois os corpos têm de tocar no chão para serem atraídos.",
                options: ["Verdadeiro", "Falso"],
                correct: 1 // É uma força à distância
            },
            {
                type: "mcq",
                question: "11. Um corpo cai em direção ao solo. Qual é a direção e o sentido da força gravítica que atua sobre ele?",
                options: [
                    "Direção horizontal, sentido de cima para baixo.",
                    "Direção vertical, sentido para o centro da Terra.",
                    "Direção oblíqua, sentido para a superfície.",
                    "Direção vertical, sentido de baixo para cima."
                ],
                correct: 1
            },
            {
                type: "fill",
                question: "12. A intensidade de uma força mede-se utilizando um instrumento de laboratório chamado...",
                correctAnswers: ["dinamometro", "dinamómetro", "Dinamómetro", "Dinamometro"]
            },
            {
                type: "tf",
                question: "13. O peso de um corpo aumenta quando este é deslocado do Equador em direção a um dos Polos.",
                options: ["Verdadeiro", "Falso"],
                correct: 0 // Verdadeiro, porque a distância ao centro da Terra diminui
            },
            
            // MASSA VS PESO
            {
                type: "match",
                question: "14. Distingue rigorosamente os conceitos de Massa e Peso:",
                pairs: [
                    { id: "massa_def", label: "Massa", correct: "opt1" },
                    { id: "peso_def", label: "Peso", correct: "opt2" }
                ],
                options: [
                    { val: "opt1", text: "Grandeza escalar, constante, medida em kg numa balança" },
                    { val: "opt2", text: "Grandeza vetorial, variável com o local, medida em N num dinamómetro" },
                    { val: "opt3", text: "Força de atrito estático que impede o movimento" }
                ]
            },
            {
                type: "mcq",
                question: "15. Uma astronauta tem uma massa de 65 kg na Terra. Se ela viajar para a Lua, o que acontecerá às suas grandezas físicas?",
                options: [
                    "A sua massa mantém-se nos 65 kg, mas o seu peso diminui.",
                    "A massa e o peso diminuem proporcionalmente.",
                    "A massa passa a zero e o peso mantém-se.",
                    "A sua massa aumenta, porque a Lua tem menos gravidade."
                ],
                correct: 0
            },
            {
                type: "fill",
                question: "16. Num determinado local da Terra, a relação entre Peso (P) e Massa (m) é uma relação de proporcionalidade _________.",
                correctAnswers: ["direta", "Direta"]
            },
            {
                type: "tf",
                question: "17. Como a força gravítica resulta da interação entre dois corpos, a força que a Terra exerce sobre a Lua tem a mesma intensidade da força que a Lua exerce sobre a Terra.",
                options: ["Verdadeiro", "Falso"],
                correct: 0
            },
            {
                type: "mcq",
                question: "18. Para calcular o peso de um corpo na superfície terrestre aplica-se a expressão matemática P = m x g. Sabendo que m = 10 kg e g ≈ 9,8 N/kg, qual é o peso do corpo?",
                options: ["98 kg", "9,8 N", "98 N", "0,98 N"],
                correct: 2
            },
            {
                type: "fill",
                question: "19. A unidade do Sistema Internacional (SI) utilizada para medir a massa de um corpo é o...",
                correctAnswers: ["quilograma", "kg", "Quilograma", "Kg", "KG", "Kilograma", "kilograma"]
            },
            {
                type: "mcq",
                question: "20. Lemos num pacote de arroz 'Peso líquido: 1 kg'. De um ponto de vista estritamente físico/científico, esta expressão está:",
                options: [
                    "Correta, porque o quilograma é a unidade de peso nos supermercados.",
                    "Incorreta, deveria dizer 'Massa líquida: 1 kg', uma vez que o kg é a unidade de massa.",
                    "Correta, porque peso e massa significam exatamente a mesma coisa.",
                    "Incorreta, porque o arroz devia ser medido num dinamómetro."
                ],
                correct: 1
            }
        ];

        const quizContainer = document.getElementById('quiz-container');
        const form = document.getElementById('quiz-form');
        const resultContainer = document.getElementById('result-container');
        const submitBtn = document.getElementById('submit-btn');

        function renderQuiz() {
            quizData.forEach((data, index) => {
                const card = document.createElement('div');
                card.className = 'question-card';
                card.id = `question-${index}`;
                
                let contentHTML = `<div class="question-title">${data.question}</div>`;

                switch(data.type) {
                    case 'mcq':
                    case 'tf':
                        contentHTML += `<ul class="options-list">`;
                        data.options.forEach((opt, optIndex) => {
                            contentHTML += `
                                <li id="li-q${index}-opt${optIndex}">
                                    <label>
                                        <input type="radio" name="q${index}" value="${optIndex}">
                                        ${opt}
                                    </label>
                                </li>`;
                        });
                        contentHTML += `</ul>`;
                        break;
                    
                    case 'fill':
                        contentHTML += `
                            <input type="text" id="input-q${index}" placeholder="Escreve a tua resposta..." autocomplete="off">
                            <span id="review-q${index}" class="review-correction" style="display:none;"></span>
                        `;
                        break;

                    case 'match':
                        let dropdownOpts = `<option value="" disabled selected>Selecionar opção correta...</option>`;
                        data.options.forEach(o => {
                            dropdownOpts += `<option value="${o.val}">${o.text}</option>`;
                        });

                        data.pairs.forEach((pair, pIndex) => {
                            contentHTML += `
                                <div class="match-row" id="row-q${index}-p${pIndex}">
                                    <div class="match-label">${pair.label}</div>
                                    <div class="match-select-container">
                                        <select id="sel-q${index}-p${pIndex}">
                                            ${dropdownOpts}
                                        </select>
                                    </div>
                                </div>
                            `;
                        });
                        break;
                }

                contentHTML += `<div class="error-msg" id="error-${index}">Resposta obrigatória para submeter o teste.</div>`;
                card.innerHTML = contentHTML;
                quizContainer.appendChild(card);
            });
        }

        form.addEventListener('submit', (e) => {
            e.preventDefault();
            let totalPoints = 0;
            let earnedPoints = 0;
            let isValid = true;

            quizData.forEach((data, index) => {
                const card = document.getElementById(`question-${index}`);
                const errorMsg = document.getElementById(`error-${index}`);
                card.classList.remove('error');
                errorMsg.style.display = 'none';

                let answered = false;

                switch(data.type) {
                    case 'mcq':
                    case 'tf':
                        answered = document.querySelector(`input[name="q${index}"]:checked`) !== null;
                        break;
                    case 'fill':
                        const textVal = document.getElementById(`input-q${index}`).value.trim();
                        answered = textVal !== "";
                        break;
                    case 'match':
                        answered = true;
                        data.pairs.forEach((p, pIndex) => {
                            const selVal = document.getElementById(`sel-q${index}-p${pIndex}`).value;
                            if(selVal === "") answered = false;
                        });
                        break;
                }

                if (!answered) {
                    isValid = false;
                    card.classList.add('error');
                    errorMsg.style.display = 'block';
                }
            });

            if (!isValid) {
                const firstError = document.querySelector('.question-card.error');
                if (firstError) firstError.scrollIntoView({ behavior: 'smooth', block: 'center' });
                return;
            }

            quizData.forEach((data, index) => {
                switch(data.type) {
                    case 'mcq':
                    case 'tf':
                        totalPoints += 1;
                        const selectedRadio = document.querySelector(`input[name="q${index}"]:checked`);
                        const radioVal = parseInt(selectedRadio.value);
                        
                        document.querySelectorAll(`input[name="q${index}"]`).forEach(i => i.disabled = true);
                        
                        const liSel = document.getElementById(`li-q${index}-opt${radioVal}`);
                        const liCor = document.getElementById(`li-q${index}-opt${data.correct}`);

                        if (radioVal === data.correct) {
                            earnedPoints += 1;
                            liSel.classList.add('correct-answer');
                        } else {
                            liSel.classList.add('wrong-answer');
                            liCor.classList.add('correct-answer');
                        }
                        break;

                    case 'fill':
                        totalPoints += 1;
                        const inputEl = document.getElementById(`input-q${index}`);
                        const userText = inputEl.value.trim().toLowerCase();
                        inputEl.disabled = true;
                        
                        const isCorrect = data.correctAnswers.some(ans => userText === ans);

                        if(isCorrect) {
                            earnedPoints += 1;
                            inputEl.style.backgroundColor = "#d4edda";
                            inputEl.style.borderColor = "var(--success-color)";
                        } else {
                            inputEl.style.backgroundColor = "#f8d7da";
                            inputEl.style.borderColor = "var(--error-color)";
                            inputEl.style.textDecoration = "line-through";
                            
                            const reviewSpan = document.getElementById(`review-q${index}`);
                            reviewSpan.textContent = `Resposta correta aceitável: ${data.correctAnswers[0]}`;
                            reviewSpan.style.display = "block";
                        }
                        break;

                    case 'match':
                        data.pairs.forEach((pair, pIndex) => {
                            totalPoints += 1;
                            const selEl = document.getElementById(`sel-q${index}-p${pIndex}`);
                            const rowEl = document.getElementById(`row-q${index}-p${pIndex}`);
                            const userSel = selEl.value;
                            
                            selEl.disabled = true;

                            if(userSel === pair.correct) {
                                earnedPoints += 1;
                                rowEl.style.borderLeft = "4px solid var(--success-color)";
                                rowEl.style.backgroundColor = "#d4edda";
                            } else {
                                rowEl.style.borderLeft = "4px solid var(--error-color)";
                                rowEl.style.backgroundColor = "#f8d7da";
                                
                                const correctText = data.options.find(o => o.val === pair.correct).text;
                                rowEl.innerHTML += `<div class="review-correction" style="width:100%; margin-top:5px;">A correspondência correta era: ${correctText}</div>`;
                            }
                        });
                        break;
                }
            });

            submitBtn.style.display = 'none';
            resultContainer.style.display = 'block';
            
            const percentage = Math.round((earnedPoints / totalPoints) * 100);
            let evalColor = percentage >= 50 ? 'var(--success-color)' : 'var(--error-color)';
            
            resultContainer.innerHTML = `
                <p style="margin: 0; font-size: 1.2rem; color: #555;">Módulo Terminado</p>
                <p style="margin: 10px 0;">Avaliação Final: <span style="color: ${evalColor}">${earnedPoints} / ${totalPoints} pontos</span> (${percentage}%)</p>
                <p style="margin: 0; font-size: 1rem; font-weight: normal; color: #666;">Verifica a correção abaixo. As tuas falhas foram marcadas a vermelho.</p>
            `;
            
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        renderQuiz();
    </script>
</body>
</html>